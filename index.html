<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expenses — Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{--blue:#0b5cff;--navy:#08306b;--muted:#6b7280;--bg:#f5f7fb;--card:#ffffff;--glass: rgba(11,92,255,0.06);}
    *{box-sizing:border-box}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:var(--bg);color:#0f172a;display:flex;min-height:100vh;}
    /* Sidebar */
    .sidebar{width:240px;background:#fff;border-right:1px solid #eef2f7;padding:20px;flex:0 0 240px}
    .menu{list-style:none;padding:0;margin:0}
    .menu-item{position:relative;margin-bottom:6px}
    .menu-link{display:block;padding:8px 12px;border-radius:8px;color:#08306b;text-decoration:none;font-weight:700;font-size:14px}
    .menu-link.active{background:linear-gradient(90deg,#eef6ff,#ffffff);border:1px solid rgba(11,92,255,0.06)}
    .has-submenu > .menu-link::after{content:"▾";float:right;font-size:12px;color:var(--muted)}
    .submenu{display:none;list-style:none;padding:6px 0 6px 12px;margin:6px 0}
    .menu-item.open .submenu{display:block}
    .submenu a{display:block;padding:6px 12px;border-radius:8px;color:#0f172a;text-decoration:none;font-weight:600;font-size:14px}
    .submenu a:hover{background:#f1f5f9}
    /* Make Expenses submenu links navy blue */
    .submenu a { color: var(--navy); }
    .submenu a:hover, .submenu a:focus { color: #0b5cff; text-decoration: none; }
    .submenu a.active { color: var(--navy); font-weight: 700; }

    /* Main content */
    main.wrap{flex:1;max-width:1200px;margin:28px auto;padding:0 20px}
    .page {padding-top:28px}
    .grid{display:grid;grid-template-columns:1fr 380px;gap:20px;align-items:start}
    .card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 8px 30px rgba(12,20,40,0.06);border:1px solid rgba(12,20,40,0.04)}
    h1{margin:0;color:var(--navy);font-size:22px}
    .lead{color:var(--muted);margin-top:6px}
    .summary{display:flex;gap:12px;margin-top:14px}
    .sum-card{flex:1;padding:14px;border-radius:10px;background:linear-gradient(180deg,#ffffff,#fbfdff);border:1px solid rgba(11,92,255,0.06)}
    .sum-title{font-size:13px;color:var(--muted);font-weight:600}
    .sum-value{font-size:20px;color:var(--navy);font-weight:700;margin-top:6px}
    .chart-wrap{margin-top:18px}
    .chart{width:100%;height:260px;background:linear-gradient(180deg,#ffffff,#fbfdff);border-radius:10px;padding:10px;border:1px solid rgba(11,92,255,0.04)}
    .small{font-size:13px;color:var(--muted)}
    .timeline{margin-top:12px}
    .timeline .event{padding:8px;border-left:3px solid var(--glass);margin-bottom:10px;background:#fff;border-radius:8px;border:1px solid rgba(2,6,23,0.03)}
    .status-pill{padding:6px 8px;border-radius:999px;font-weight:700;font-size:13px;display:inline-block}
    .s-pending{background:#fff7ed;color:#9a5800}
    .donut-wrap{display:flex;gap:12px;align-items:center;margin-top:12px}
    .donut-legend{flex:1}
    .nav-links{display:none} /* removed bottom nav links as requested */

    /* Upload box: dashed border and drag state */
    .upload-box{
      border: 2px dashed #cbd5e1;
      border-radius: 10px;
      padding: 18px;
      text-align: center;
      color: var(--muted);
      cursor: pointer;
      position: relative;
      background: linear-gradient(180deg, rgba(11,92,255,0.02), rgba(255,255,255,0.00));
      transition: background .18s ease, border-color .18s ease, box-shadow .18s ease;
    }
    .upload-box:hover { background: linear-gradient(180deg, rgba(11,92,255,0.04), rgba(255,255,255,0.00)); border-color: #9fb7ff; box-shadow: 0 6px 18px rgba(11,92,255,0.06); }
    .upload-box.dragover { background: linear-gradient(180deg, rgba(11,92,255,0.08), rgba(255,255,255,0.00)); border-color: #0b5cff; box-shadow: 0 8px 26px rgba(11,92,255,0.10); }
    .upload-box .hint { font-size: 14px; color: var(--muted); }
    /* remove underlines from invoice links and summary link */
    a.inv, a.inv:link, a.inv:visited, a.sum-link, a.sum-link:link, a.sum-link:visited { text-decoration: none; }
    a.inv:hover, a.sum-link:hover { text-decoration: none; color: #0b5cff; }

    @media(max-width:1000px){ .sidebar{display:none} .grid{grid-template-columns:1fr} }

    /* Upload status / progress item styles (paste near other upload/progress rules) */
    /* Fix upload controls alignment and prevent overflow */
.upload-item .top { display:flex; gap:12px; align-items:center; justify-content:space-between; }
.upload-item .meta { display:flex; gap:10px; align-items:center; min-width:0; flex:1 1 auto; }
.upload-item .meta > div { min-width:0; }
.upload-item .file-name { overflow:hidden; text-overflow:ellipsis; white-space:nowrap; min-width:0; }
.upload-controls { flex:0 0 auto; display:flex; gap:8px; align-items:center; margin-left:12px; }
.upload-controls .action-btn { padding:6px 10px; font-size:13px; white-space:nowrap; }
.upload-item { overflow:visible; }

/* Optional polish for Delete button */
.upload-controls .action-btn[data-action="delete"] { background:#fff; border:1px solid #e6eef6; color:var(--navy); }

    .upload-item{display:flex;flex-direction:column;gap:8px}
    .upload-item > .top{display:flex;justify-content:space-between;align-items:center}
    .upload-item .meta{display:flex;gap:10px;align-items:center}
    .upload-item .file-badge{width:36px;height:36;border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:700}
    .upload-item .file-name{font-weight:700;color:var(--navy)}
    .upload-item .small-muted{font-size:13px;color:var(--muted)}
    .upload-controls{display:flex;gap:8px;align-items:center}
    .progress-track{flex:1;background:#f1f5f9;border-radius:8px;height:10px;overflow:hidden}
    .progress-bar{height:100%;width:0%;transition:width .3s linear}
    .upload-item[data-state="done"] .progress-bar{width:100%}
    .upload-item .action-btn{padding:6px 10px;border-radius:8px;border:1px solid #e6eef6;background:#fff;cursor:pointer}
    .upload-item .action-btn[disabled]{opacity:.6;cursor:not-allowed}
  </style>
</head>
<body>

  <!-- Sidebar -->
  <aside class="sidebar" aria-label="Main navigation">
    <ul class="menu" id="mainMenu">
      <li class="menu-item has-submenu open" data-key="expenses">
        <a href="index.html" class="menu-link active" id="menu-expenses">Expenses</a>
        <ul class="submenu">
          <li><a href="Assistant_Invoice_Management.html">Invoice Management</a></li>
          <li><a href="Assistant_Module_Settings.html">Module Settings</a></li>
        </ul>
      </li>
    </ul>
  </aside>

  <!-- Main content -->
  <main class="wrap page" role="main" aria-label="Expenses dashboard">
    <div class="grid">
      <!-- Left: Dashboard -->
      <section class="left-panel">
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <h1>Hello, Theresa</h1>
              <div class="lead">Expense Dashboard</div>
            </div>
          </div>

          <div class="summary" aria-hidden="false">
            <div class="sum-card">
              <div class="sum-title">Pending Reviews</div>
              <div class="sum-value"><a href="Assistant_Invoice_Management.html?filter=pending" class="sum-link" style="color:var(--blue);text-decoration:underline">8</a></div>
              <div class="small" style="margin-top:8px">Invoices awaiting Director approval</div>
            </div>

            <div class="sum-card">
              <div class="sum-title">Total Invoices</div>
              <div class="sum-value">24</div>
              <div class="small" style="margin-top:8px">Records in the system</div>
            </div>

            <div class="sum-card">
              <div class="sum-title">Total Value</div>
              <div class="sum-value" id="totalValue">$28,430</div>
              <div class="small" style="margin-top:8px">Sum of invoice amounts</div>
            </div>
          </div>

          <div class="chart-wrap">
            <div class="chart" role="img" aria-label="Expenses vs Revenue chart showing months January to October and Y-axis values 30k to 120k">
              <svg viewBox="0 0 820 260" preserveAspectRatio="xMidYMid meet" style="width:100%;height:100%">
                <defs><linearGradient id="g1" x1="0" x2="0" y1="0" y2="1"><stop offset="0" stop-color="#e6f0ff"/><stop offset="1" stop-color="#ffffff"/></linearGradient></defs>
                <rect x="0" y="0" width="100%" height="100%" fill="url(#g1)"></rect>
                <g fill="#94a3b8" font-size="12" text-anchor="end" font-family="Inter, system-ui, Arial">
                  <text x="48" y="40">120k</text>
                  <text x="48" y="90">90k</text>
                  <text x="48" y="140">60k</text>
                  <text x="48" y="190">30k</text>
                </g>
                <g stroke="#eef4ff" stroke-width="1">
                  <line x1="60" x2="780" y1="30" y2="30"></line>
                  <line x1="60" x2="780" y1="80" y2="80"></line>
                  <line x1="60" x2="780" y1="130" y2="130"></line>
                  <line x1="60" x2="780" y1="180" y2="180"></line>
                </g>
                <g stroke="#dbeafe" stroke-width="1"><line x1="60" x2="60" y1="20" y2="200"></line></g>
                <polyline fill="none" stroke="#0b5cff" stroke-width="3" points="60,150 140,130 220,90 300,60 380,80 460,70 540,90 620,100 700,80 780,60"></polyline>
                <polyline fill="none" stroke="#9aaedb" stroke-width="2" points="60,160 140,155 220,150 300,145 380,148 460,142 540,145 620,150 700,148 780,145"></polyline>
                <g fill="#94a3b8" font-size="12" text-anchor="middle" font-family="Inter, system-ui, Arial">
                  <text x="60"  y="225">Jan</text>
                  <text x="140" y="225">Feb</text>
                  <text x="220" y="225">Mar</text>
                  <text x="300" y="225">Apr</text>
                  <text x="380" y="225">May</text>
                  <text x="460" y="225">Jun</text>
                  <text x="540" y="225">Jul</text>
                  <text x="620" y="225">Aug</text>
                  <text x="700" y="225">Sep</text>
                  <text x="780" y="225">Oct</text>
                </g>
                <g font-family="Inter, system-ui, Arial" font-size="13" fill="#0f172a">
                  <text x="780" y="20" text-anchor="end" font-weight="700">Total: $28,430</text>
                </g>
              </svg>
            </div>

            <div style="display:flex;gap:12px;margin-top:12px;align-items:center">
              <div class="card" style="flex:1">
                <div style="display:flex;justify-content:space-between;align-items:center">
                  <div><strong>Category Breakdown</strong><div class="small">Top 4 categories</div></div>
                  <div class="small">Last 30 days</div>
                </div>

                <div class="donut-wrap">
                  <div style="width:120px;height:120px">
                    <svg viewBox="0 0 32 32" style="width:100%;height:100%">
                      <circle r="10" cx="16" cy="16" fill="transparent" stroke="#eef2ff" stroke-width="10"></circle>
                      <circle r="10" cx="16" cy="16" fill="transparent" stroke="#1E88E5" stroke-width="10" stroke-dasharray="22 40.8" stroke-dashoffset="0"></circle>
                      <circle r="10" cx="16" cy="16" fill="transparent" stroke="#42A5F5" stroke-width="10" stroke-dasharray="18.2 44.6" stroke-dashoffset="22"></circle>
                      <circle r="10" cx="16" cy="16" fill="transparent" stroke="#64B5F6" stroke-width="10" stroke-dasharray="12.6 50.2" stroke-dashoffset="40.2"></circle>
                      <circle r="10" cx="16" cy="16" fill="transparent" stroke="#90CAF9" stroke-width="10" stroke-dasharray="10 52.8" stroke-dashoffset="52.8"></circle>
                    </svg>
                  </div>

                  <div class="donut-legend">
                    <div class="small"><strong>Office Supplies</strong> <div class="small" style="color:var(--muted)">$7,200</div></div>
                    <div style="height:8px"></div>
                    <div class="small"><strong>Travel</strong> <div class="small" style="color:var(--muted)">$5,900</div></div>
                    <div style="height:8px"></div>
                    <div class="small"><strong>Food & Catering</strong> <div class="small" style="color:var(--muted)">$4,080</div></div>
                    <div style="height:8px"></div>
                    <div class="small"><strong>Equipment</strong> <div class="small" style="color:var(--muted)">$2,670</div></div>
                  </div>
                </div>
              </div>

              <div style="width:320px" class="card">
                <div style="display:flex;justify-content:space-between;align-items:center">
                  <div><strong>Pending Reviews</strong><div class="small">Needs Assistant action</div></div>
                  <div style="text-align:right"><span class="status-pill s-pending">Pending</span></div>
                </div>

                <div class="timeline" id="pendingList" style="margin-top:12px">
                  <div class="event"><strong><a class="inv" data-inv="INV-2025-001" href="Assistant_View_Invoice.html?inv=INV-2025-001">INV-2025-001</a></strong><div class="small">ABC Supplies • $1,250 • 2 attachments</div></div>
                  <div class="event"><strong><a class="inv" data-inv="INV-2025-002" href="Assistant_View_Invoice.html?inv=INV-2025-002">INV-2025-002</a></strong><div class="small">Travel Co • $420 • 1 attachment</div></div>
                  <div class="event"><strong><a class="inv" data-inv="INV-2025-003" href="Assistant_View_Invoice.html?inv=INV-2025-003">INV-2025-003</a></strong><div class="small">OfficeMax • $210 • 0 attachments</div></div>
                  <div class="event"><strong><a class="inv" data-inv="INV-2025-004" href="Assistant_View_Invoice.html?inv=INV-2025-004">INV-2025-004</a></strong><div class="small">Catering Ltd • $980 • 1 attachment</div></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Right: Side panel -->
      <aside class="right-panel">
        <div class="card" id="quickUploadCard" style="margin-bottom:12px">
          <strong>Quick Upload</strong>
          <div class="small" style="margin-top:6px">Drag & drop files or click to select</div>

          <!-- Updated upload area with dashed border and dragover handling -->
          <div class="upload-box" id="quickUpload" style="margin-top:10px; position:relative;">
            <div class="hint">Drop files here or click to upload</div>
            <input type="file" id="quickFileInput" style="opacity:0;position:absolute;top:0;left:0;width:100%;height:100%;cursor:pointer;" multiple />
          </div>

          <div id="quickFileNames" style="margin-top:12px; font-size:13px; color:var(--navy);"></div>
        </div>

        <div class="card" id="uploadStatusCard" style="margin-bottom:12px">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div><strong>Upload Status & Progress</strong><div class="small" style="margin-top:4px">Recent uploads and OCR progress</div></div>
            <div style="display:flex;gap:8px;align-items:center"><button id="clearUploadList" style="background:#fff;border:1px solid #e6eef6;padding:6px 10px;border-radius:8px;cursor:pointer">Clear</button></div>
          </div>

          <div id="uploadList" style="margin-top:12px;display:flex;flex-direction:column;gap:12px">
            <!-- Demo PDF upload item -->
            <div class="upload-item" data-id="u1" data-state="uploading">
              <div class="top">
                <div class="meta">
                  <div class="file-badge" style="background:#eef6ff;color:var(--navy)">PDF</div>
                  <div>
                    <div class="file-name">invoice_oct_001.pdf</div>
                    <div class="small-muted">Uploading • 1.2 MB</div>
                  </div>
                </div>
                <div class="upload-controls">
                  <div id="status-u1" class="small-muted">Uploading</div>
                  <button class="action-btn" data-action="cancel" data-id="u1">Cancel</button>
                </div>
              </div>
              <div style="display:flex;gap:12px;align-items:center;margin-top:8px">
                <div class="progress-track"><div id="progress-u1" class="progress-bar" style="background:linear-gradient(90deg,var(--blue),#6ea8ff);width:0%"></div></div>
                <div style="width:56px;text-align:right;font-weight:700" id="percent-u1">0%</div>
              </div>
            </div>

            <!-- Demo IMG upload item -->
            <div class="upload-item" data-id="u2" data-state="queued">
              <div class="top">
                <div class="meta">
                  <div class="file-badge" style="background:#fff7ed;color:#9a5800">IMG</div>
                  <div>
                    <div class="file-name">receipt_sep_22.jpg</div>
                    <div class="small-muted">OCR processing • 0.4 MB</div>
                  </div>
                </div>
                <div class="upload-controls">
                  <div id="status-u2" class="small-muted">Queued</div>
                  <button class="action-btn" data-action="cancel" data-id="u2">Cancel</button>
                </div>
              </div>
              <div style="display:flex;gap:12px;align-items:center;margin-top:8px">
                <div class="progress-track"><div id="progress-u2" class="progress-bar" style="background:linear-gradient(90deg,#f59e0b,#ffd08a);width:0%"></div></div>
                <div style="width:56px;text-align:right;font-weight:700" id="percent-u2">0%</div>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <strong>Recent Activity</strong>
          <div class="small" style="margin-top:8px">Latest system events and actions</div>
          <div style="margin-top:10px">
            <div class="small" style="margin-bottom:8px"><strong><a class="inv" data-inv="INV-2025-002" href="Assistant_View_Invoice.html?inv=INV-2025-002">INV-2025-002</a></strong> submitted by HR Assistant • 2 hours ago</div>
            <div class="small" style="margin-bottom:8px"><strong><a class="inv" data-inv="INV-2025-001" href="Assistant_View_Invoice.html?inv=INV-2025-001">INV-2025-001</a></strong> edited by HR Assistant • 1 hour ago</div>
            <div class="small" style="margin-bottom:8px"><strong><a class="inv" data-inv="INV-2025-003" href="Assistant_View_Invoice.html?inv=INV-2025-003">INV-2025-003</a></strong> approved by Director • 3 days ago</div>
          </div>
        </div>
      </aside>
    </div>
  </main>

  <script>
    // Sidebar submenu toggle behavior (hover + click support)
    document.querySelectorAll('.menu-item.has-submenu > .menu-link').forEach(link=>{
      link.addEventListener('click', (e)=>{
        if (e.ctrlKey || e.metaKey) return;
        const parent = link.parentElement;
        const isOpen = parent.classList.contains('open');
        document.querySelectorAll('.menu-item.has-submenu').forEach(mi=>mi.classList.remove('open'));
        if (!isOpen) parent.classList.add('open');
      });
      link.addEventListener('mouseover', ()=> { const parent = link.parentElement; parent.classList.add('open'); });
    });

    // Make initial menu state reflect current page (simple heuristic)
    (function highlightCurrent(){
      const path = window.location.pathname.split('/').pop() || 'homepage.html';
      if (path.toLowerCase().includes('expenses')) {
        document.getElementById('menu-expenses')?.classList.add('active');
        document.querySelector('[data-key="expenses"]')?.classList.add('open');
      }
    })();

    // Quick upload UI: show filenames and handle drag visual state
    const quickFileInput = document.getElementById('quickFileInput'), quickFileNames = document.getElementById('quickFileNames');
    const quickUpload = document.getElementById('quickUpload');

    if (quickFileInput) {
      quickFileInput.addEventListener('change', (e)=>{
        const files = Array.from(e.target.files || []);
        quickFileNames.innerHTML = files.length ? files.map(f=>`<div>${f.name}</div>`).join('') : '';
      });
    }

    if (quickUpload) {
      quickUpload.addEventListener('dragover', e=>{ e.preventDefault(); quickUpload.classList.add('dragover'); quickUpload.style.background="rgba(11,92,255,0.06)"; });
      quickUpload.addEventListener('dragleave', e=>{ e.preventDefault(); quickUpload.classList.remove('dragover'); quickUpload.style.background=""; });
      quickUpload.addEventListener('drop', e=>{ e.preventDefault(); quickUpload.classList.remove('dragover'); quickUpload.style.background=""; if (e.dataTransfer.files && e.dataTransfer.files.length) { quickFileInput.files = e.dataTransfer.files; quickFileInput.dispatchEvent(new Event('change')); }});
    }

    // Clear upload list demo
    document.getElementById('clearUploadList')?.addEventListener('click', ()=>{
      const list = document.getElementById('uploadList');
      if (list) list.innerHTML = '<div class="small-muted" style="padding:12px">No recent uploads</div>';
    });

    /* --- Upload Status & Progress simulation and controls (copied from index behavior) --- */
    (function(){
      const items = [
        { id: 'u1', name: 'invoice_oct_001.pdf', sizeMB: 1.2 },
        { id: 'u2', name: 'receipt_sep_22.jpg', sizeMB: 0.4 }
      ];
      const progressState = {};
      items.forEach((it, i) => {
        progressState[it.id] = { pct: 0, stage: i === 0 ? 'uploading' : 'queued' };
        const statusEl = document.getElementById('status-' + it.id);
        if(statusEl) statusEl.textContent = progressState[it.id].stage.charAt(0).toUpperCase() + progressState[it.id].stage.slice(1);
      });

      function startSimulation(id){
        const interval = setInterval(()=> {
          const st = progressState[id];
          if(!st) { clearInterval(interval); return; }
          if(st.stage === 'queued') {
            st.pct += 1;
            if(st.pct >= 5) st.stage = 'uploading';
          } else if(st.stage === 'uploading') {
            st.pct += 6 + Math.random() * 4;
            if(st.pct >= 90) { st.pct = 90; st.stage = 'ocr'; }
          } else if(st.stage === 'ocr') {
            st.pct += 3 + Math.random() * 4;
            if(st.pct >= 100) { st.pct = 100; st.stage = 'done'; }
          } else if(st.stage === 'done') {
            clearInterval(interval);
          }
          updateUI(id, st.pct, st.stage);
        }, 400);
      }

      function updateUI(id, pct, stage){
        const progressEl = document.getElementById('progress-' + id);
        const percentEl = document.getElementById('percent-' + id);
        const statusEl = document.getElementById('status-' + id);
        if(progressEl) progressEl.style.width = Math.min(100, Math.round(pct)) + '%';
        if(percentEl) percentEl.textContent = Math.min(100, Math.round(pct)) + '%';
        if(statusEl) {
          const label = stage === 'queued' ? 'Queued' : stage === 'uploading' ? 'Uploading' : stage === 'ocr' ? 'OCR processing' : stage === 'done' ? 'Complete' : stage === 'cancelled' ? 'Cancelled' : '';
          statusEl.textContent = label;
        }
        if(stage === 'done'){
          const item = document.querySelector(`.upload-item[data-id="${id}"]`);
          if(item){
            item.dataset.state = 'done';
            item.querySelectorAll('.action-btn').forEach(b=>b.remove());
            const openBtn = document.createElement('button'); openBtn.className = 'action-btn'; openBtn.dataset.action = 'open'; openBtn.dataset.id = id; openBtn.textContent = 'Open';
            const delBtn = document.createElement('button'); delBtn.className = 'action-btn'; delBtn.dataset.action = 'delete'; delBtn.dataset.id = id; delBtn.textContent = 'Delete';
            const controlArea = item.querySelector('.upload-controls') || (() => {
              const c = document.createElement('div'); c.className = 'upload-controls'; c.style.display = 'flex'; c.style.gap = '8px'; c.style.alignItems = 'center';
              const top = item.querySelector('.top');
              if(top){
                const old = top.querySelector('div:last-child');
                if(old) old.parentElement.replaceChild(c, old);
              }
              return c;
            })();
            controlArea.appendChild(openBtn);
            controlArea.appendChild(delBtn);
          }
        }
      }

      setTimeout(()=> startSimulation('u1'), 200);
      setTimeout(()=> startSimulation('u2'), 1200);

      const uploadList = document.getElementById('uploadList');
      if(uploadList){
        uploadList.addEventListener('click', e => {
          const btn = e.target.closest('.action-btn');
          if(!btn) return;
          const action = btn.dataset.action || btn.getAttribute('data-action');
          const id = btn.dataset.id || btn.getAttribute('data-id');
          if(action === 'cancel'){
            if(progressState[id]) { progressState[id].stage = 'cancelled'; updateUI(id, 0, 'cancelled'); }
            btn.textContent = 'Cancelled'; btn.disabled = true;
            const statusEl = document.getElementById('status-' + id);
            if(statusEl) statusEl.textContent = 'Cancelled';
          } else if(action === 'open'){
            window.location.href = 'Assistant_View_Invoice.html';
          } else if(action === 'delete'){
            const item = document.querySelector(`.upload-item[data-id="${id}"]`);
            if(item) item.remove();
          }
        });
      }
    })();
  </script>
</body>
</html>
